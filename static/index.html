<!doctype html>
<meta charset="utf-8">
<title>로또 예측 — 진단/안정화</title>
<body style="background:#0f172a;color:#e5e7eb;font-family:system-ui;margin:0">
  <div style="max-width:900px;margin:0 auto;padding:16px">
    <h2>로또 예측(안정화)</h2>
    <div id="status">체크 중…</div>
    <pre id="log" style="white-space:pre-wrap;background:#111827;padding:12px;border-radius:10px;margin-top:8px"></pre>
  </div>
  <script>
    const s = (t)=>document.getElementById('status').textContent=t;
    const l = (m)=>document.getElementById('log').textContent+=m+"\\n";
    async function j(url){const r=await fetch(url,{cache:'no-store'});const t=await r.text();try{return{ok:r.ok,status:r.status,json:JSON.parse(t)}}catch{return{ok:r.ok,status:r.status,text:t}}}
    (async ()=>{
      s('health…'); let r=await j('/health'); l(`/health -> ${r.status} ${r.ok}`); if(!r.ok) return s('서버 기동 실패');
      s('diag…');   r=await j('/diag');   l(`/diag -> ${r.status} ${r.ok}\\n`+JSON.stringify(r.json||r.text,null,2));
      s('probe…');  r=await j('/api/probe'); l(`/api/probe -> ${r.status} ${r.ok}\\n`+JSON.stringify(r.json||r.text,null,2));
      s('stats…');  r=await j('/api/stats?last=20'); l(`/api/stats -> ${r.status} ${r.ok}`); if(!r.ok) return s('통계 API 실패');
      s((r.json&&r.json.count)?`OK: 최근 ${r.json.count}회`:'데모 데이터');
    })();
  </script>
</body>
